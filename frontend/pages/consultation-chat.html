<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Chat - HealthCare AI</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/responsive.css">

    <style>
        .chat-page {
            display: flex;
            flex-direction: column;
            height: 100vh;
            background: var(--color-white);
        }

        .chat-header {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            padding: var(--space-4);
            background: var(--color-white);
            border-bottom: 1px solid var(--color-border);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .back-btn {
            padding: var(--space-2);
            background: transparent;
            border: none;
            color: var(--color-text-muted);
            cursor: pointer;
            border-radius: var(--radius-md);
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
        }

        .back-btn:hover {
            background: var(--color-bg-muted);
            color: var(--color-text);
        }

        .chat-avatar {
            width: 44px;
            height: 44px;
            background: var(--color-primary);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-white);
        }

        .chat-title-section {
            flex: 1;
        }

        .chat-title {
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
            font-size: var(--font-size-base);
        }

        .chat-status {
            font-size: var(--font-size-sm);
            color: var(--color-warning);
            display: flex;
            align-items: center;
            gap: var(--space-1);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--color-warning);
            border-radius: var(--radius-full);
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-4);
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .message {
            display: flex;
            gap: var(--space-3);
            max-width: 85%;
            animation: fadeInUp 0.3s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            color: var(--color-white);
        }

        .message.ai .message-avatar {
            background: var(--color-primary);
        }

        .message.user .message-avatar {
            background: var(--color-text-light);
        }

        .message-content {
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }

        .message-bubble {
            padding: var(--space-4);
            border-radius: var(--radius-xl);
            line-height: var(--line-height-relaxed);
            font-size: var(--font-size-sm);
        }

        .message.ai .message-bubble {
            background: var(--color-bg-subtle);
            border: 1px solid var(--color-border);
            color: var(--color-text);
        }

        .message.user .message-bubble {
            background: var(--color-primary);
            color: var(--color-white);
        }

        .message-time {
            font-size: var(--font-size-xs);
            color: var(--color-text-muted);
            padding: 0 var(--space-2);
        }

        .message.user .message-time {
            text-align: right;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) 0;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
            padding: var(--space-4);
            background: var(--color-bg-subtle);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-xl);
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            background: var(--color-text-muted);
            border-radius: var(--radius-full);
            animation: typingBounce 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingBounce {

            0%,
            80%,
            100% {
                transform: scale(0.8);
                opacity: 0.5;
            }

            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .chat-input-area {
            padding: var(--space-4);
            background: var(--color-white);
            border-top: 1px solid var(--color-border);
        }

        .input-container {
            display: flex;
            align-items: flex-end;
            gap: var(--space-3);
            max-width: 800px;
            margin: 0 auto;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        .chat-input {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-xl);
            font-size: var(--font-size-sm);
            resize: none;
            min-height: 44px;
            max-height: 150px;
            transition: border-color var(--transition-fast);
            font-family: var(--font-family);
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .send-btn {
            width: 44px;
            height: 44px;
            background: var(--color-primary);
            border: none;
            border-radius: var(--radius-full);
            color: var(--color-white);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
            flex-shrink: 0;
        }

        .send-btn:hover {
            background: var(--color-primary-dark);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .dev-notice {
            background: var(--color-warning-bg);
            border: 1px solid var(--color-warning);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin: var(--space-4);
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
        }

        .dev-notice-icon {
            color: var(--color-warning);
            flex-shrink: 0;
        }

        .dev-notice-content h4 {
            color: var(--color-warning);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--space-1);
        }

        .dev-notice-content p {
            color: var(--color-text-light);
            font-size: var(--font-size-sm);
            margin: 0;
        }

        @media (min-width: 768px) {
            .message {
                max-width: 70%;
            }

            .chat-container {
                padding: var(--space-6);
                max-width: 900px;
                margin: 0 auto;
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <div class="chat-page">
        <!-- Chat Header -->
        <div class="chat-header">
            <a href="patient-dashboard.html" class="back-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </a>
            <div class="chat-avatar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                </svg>
            </div>
            <div class="chat-title-section">
                <div class="chat-title">AI Health Assistant</div>
                <div class="chat-status">
                    <span class="status-dot"></span>
                    Development Mode
                </div>
            </div>
        </div>

        <!-- Development Notice -->
        <div class="dev-notice">
            <svg class="dev-notice-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" />
                <line x1="12" y1="9" x2="12" y2="13" />
                <line x1="12" y1="17" x2="12.01" y2="17" />
            </svg>
            <div class="dev-notice-content">
                <h4>Development Mode</h4>
                <p>AI assistant is currently under development. For immediate assistance, please consult with a nearby
                    doctor.</p>
            </div>
        </div>

        <!-- Chat Messages -->
        <div class="chat-container" id="chat-container">
            <!-- AI Welcome Message -->
            <div class="message ai">
                <div class="message-avatar">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                    </svg>
                </div>
                <div class="message-content">
                    <div class="message-bubble">
                        <p style="margin: 0 0 var(--space-3) 0;">Hello! I'm your AI Health Assistant.</p>
                        <p style="margin: 0;">I am currently under development mode. For any health concerns, kindly
                            make a consultation with a nearby doctor.</p>
                    </div>
                    <div class="message-time">Just now</div>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="chat-input-area">
            <div class="input-container">
                <div class="input-wrapper">
                    <textarea class="chat-input" id="chat-input" placeholder="Type your message..." rows="1"></textarea>
                </div>
                <button class="send-btn" id="send-btn" onclick="sendMessage()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script src="../js/transitions.js"></script>
    <script>
        const chatContainer = document.getElementById('chat-container');
        const chatInput = document.getElementById('chat-input');
        const sendBtn = document.getElementById('send-btn');

        // Auto-resize textarea
        chatInput.addEventListener('input', function () {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 150) + 'px';
            sendBtn.disabled = !this.value.trim();
        });

        // Send on Enter
        chatInput.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                if (this.value.trim()) {
                    sendMessage();
                }
            }
        });

        function sendMessage() {
            const text = chatInput.value.trim();
            if (!text) return;

            // Add user message
            addMessage(text, 'user');
            chatInput.value = '';
            chatInput.style.height = 'auto';
            sendBtn.disabled = true;

            // Show typing indicator
            showTypingIndicator();

            // Offline response
            setTimeout(() => {
                hideTypingIndicator();
                addMessage(
                    "I am currently under development mode, kindly make a consultation with nearby doctor.",
                    'ai'
                );
            }, 1000);
        }

        function addMessage(text, sender) {
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const avatarIcon = sender === 'ai'
                ? '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>'
                : '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>';

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatarIcon}</div>
                <div class="message-content">
                    <div class="message-bubble">${text}</div>
                    <div class="message-time">${time}</div>
                </div>
            `;

            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function showTypingIndicator() {
            const indicator = document.createElement('div');
            indicator.className = 'typing-indicator';
            indicator.id = 'typing-indicator';
            indicator.innerHTML = `
                <div class="message-avatar" style="background: var(--color-primary); width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                </div>
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;
            chatContainer.appendChild(indicator);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }
    </script>
</body>

</html>